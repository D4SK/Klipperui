#:kivy 1.8.0
#:import Factory kivy.factory.Factory
#:import p parameters

Tabs:
   
<Tabs@TabbedPanel>:
    tab_pos: 'bottom_mid'
    tab_width: p.screen_width/3
    tab_height: 100
    do_default_tab: False
    HomeTab:
        HomeScreenManager:           
    FileTab:
    SettingTab:


#LABELS: try putting the label inside a widget or set hints to None if it does shit e.g. setting size doesnt work
# size: outer dimensions of the label widget, available space, can be set to texture_size to show everything SYNTAX!!! size: '137.5dp', '31sp'
# text_size: can be set to limit texture size e.g. cut off text, can be set to size to show all that fits, 
# texture_size: size of the actual text not cut off(outer dimensions), can set font_size

# HOME -------------------------------------------------------------
<HomeTab@TabbedPanelItem>:
    canvas:
        Rectangle:
            source: 'Logos/HomeIcon.png'
            size: 100, 100
            pos: 50, 0
    background_down: '' # dadurch nimmt es background color an, sowieso immer mit dessen opacity auch waere es ein bild
    background_normal: 'Logos/Black.png'
    background_color: p.background

<HomeScreenManager@ScreenManager>:
    HomeScreen:
    PrintingScreen: 

<HomeScreen@Screen>:
    size: root.size
    name: "homescreen"
    Background:

<PrintingScreen@Screen>:
    name: "printingscreen"
    Label:
        id:l
        text: "PrintingScreen"



# FILE -------------------------------------------------------------
<FileTab@TabbedPanelItem>:
    canvas:
        Rectangle:
            source: 'Logos/FilesIcon.png'
            size: 100,100
            pos: 250, 0
    background_down: ''
    background_normal: 'Logos/Black.png'
    background_color: p.background
    FC:
<FC>:
    filters: '*.gco', '*.gcode'
    rootpath: '/'
    id: fc
    multiselect: 'False'
    canvas.before:         
        Color:
            rgba: 0.1, 0.1, 0.1, 1 
        Rectangle:
            pos: 0,0 #seems to use relative positioning to its screen put 0,0 instead of self.pos
            size: p.screen_width,924




# SETTING ----------------------------------------------------------
<SettingTab@TabbedPanelItem>:
    canvas:
        Rectangle:
            source: 'Logos/SettingsIcon.png'
            size: 100, 100
            pos: 450, 0
    background_down: '' 
    background_normal: 'Logos/Black.png'
    background_color: p.background
    ScreenManager:
        name: 'SettingScreenManager'
        SettingScreen:
        WifiScreen:
        
<SettingScreen@Screen>:
    name: 'SettingScreen'
    ScrollView:
        canvas.before:
            Color:
                rgba: p.background
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            canvas:
                Color:
                    rgba: p.background #set Background colour for settings
                Rectangle:
                    size: self.size
                    pos: self.pos
            orientation:'vertical'
            height: self.minimum_height
            pos: 0, root.height - self.height
            size_hint_y: None

            SettingSwitch:
                title: "Light"
            SettingSwitch:
                title: "Calibrate for every printjob"
            SettingWifi:
                title: "Wifi"
                Button:
                    pos_hint: {'x':0, 'y':0}
                    background_normal: 'Logos/Transparent.png'
                    background_down: ''
                    background_color: [1,1,1, 0.1]
                    on_press:
                        root.manager.transition.direction = 'left'
                        root.manager.current = 'WifiScreen'
            SettingValueSlider:
                title: "Max. printhead Acceleration" 
                value: '777'
                Button:
                    pos_hint: {'x':0, 'y':0}
                    background_normal: 'Logos/Transparent.png'
                    background_down: ''
                    background_color: [1,1,1, 0.1]
                    on_release: Factory.ValuePopup().open()

<WifiScreen>:
    name: 'WifiScreen'
    ScrollView:
        do_scroll_x: False
        canvas.before:
            Color:
                rgba: p.background
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            canvas:
                Color:
                    rgba: p.background
                Rectangle:
                    size: self.size
                    pos: self.pos
            orientation:'vertical'
            height: self.minimum_height
            size_hint_y: None

            SetItem:
                id: wifi_back
                Button:
                    canvas:
                        Rectangle:
                            source: 'Logos/BackButton.png'
                            size: 70, 70
                            pos: 30, self.y+20
                    background_normal: 'Logos/Transparent.png'
                    background_down: ''
                    background_color: 1,1,1,0.1
                    pos_hint: {'x':0, 'y': 0}
                    size_hint_x: None
                    width: 110
                    on_press:
                        root.manager.transition.direction = 'right'
                        root.manager.current = 'SettingScreen'
                Label:
                    text: "Wifi"
                    font_size: p.big_font
                    text_size: self.size
                    size_hint: 1, 1
                    pos_hint: {'x': 0, 'y': 0}
                    valign: 'middle'
                    halign: 'center'
            BoxLayout:
                canvas:
                    Color:
                        rgba: p.background
                    Rectangle:
                        pos: self.pos
                        size: self.size
                id: wifi_box
                orientation: 'vertical'
                height: self.minimum_height
                size_hint_y: None
                
            
<SetItem>:
    size_hint_y: None
    height: 110
    width: p.screen_width
    title: ''
    Label:
        id: switch_id
        text: root.title
        font_size: '20sp'
        text_size: self.size
        size: root.size
        valign: 'middle'
        pos: root.pos
        padding_x: 50
    SettingDivider:

<SettingDivider@Widget>:
    size_hint_y: None
    height: 1
    width: p.screen_width
    pos_hint: {'x': 0, 'y': 0}
    canvas:
        Color:
            rgba: p.medium_gray
        Rectangle:
            pos: self.x+15, self.y
            size: self.width -30, 1

<SettingSwitch@SetItem>:
    Switch:
        id: knopf
        size_hint: None, None
        pos_hint: {'center_y': 0.5}
        right: p.screen_width-50

<SettingValueSlider@SetItem>:
    value: ''
    Label:
        id: value
        text: root.value
        font_size: p.normal_font
        text_size: self.size
        color: p.light_gray
        size: 200, root.height
        size_hint: None, None
        valign: 'middle'
        halign: 'right'
        y: root.y
        right: p.screen_width
        padding_x: 50

<SettingWifi@SetItem>:
    Label:
        id: current_wifi
        text: '[current]'
        font_size: p.normal_font
        text_size: self.size
        color: p.light_gray
        size: 200, root.height
        size_hint: None, None
        valign: 'middle'
        halign: 'right'
        y: root.y
        right: p.screen_width
        padding_x: 50


<SettingUpdate@SetItem>:
<SettingSystemInfo@SetItem>:

<WifiNetwork>:
    Label:
        text: root.ssid
        font_size: p.normal_font
        text_size: self.size
        color: p.light_gray
        size: 200, root.height
        size_hint: None, None
        valign: 'middle'
        halign: 'right'
        y: root.y
        right: p.screen_width
        padding_x: 50

<ValuePopup@Popup>:
    auto_dismiss: False
    


<PasswordPopup>:
    title_size: 30
    size_hint: 0.8, 0.5
    txt_input: pwd_input
    FloatLayout:
        Label:
            text: 'Password'
            font_size: p.normal_font
            size: self.texture_size
            size_hint: None, None
            pos_hint: {'x': 0.1, 'y': 0.75}
        TextInput:
            id: pwd_input
            multiline: False
            focus: True
            password: True
            height: self.minimum_height
            size_hint: 0.7, None
            pos_hint: {'x': 0.1, 'top': 0.73}
        ToggleButton:
            text: 'show'
            on_press: 
                if self.state == 'down': pwd_input.password = False
                elif self.state == 'normal': pwd_input.password = True
            height: pwd_input.height
            size_hint: 0.1, None
            pos_hint: {'x': 0.8, 'top': 0.73}
        Button:
            id: btn_cancel
            text: 'Cancel'
            size_hint: 0.2, 0.1
            pos_hint: {'x': 0.48, 'y': 0.1}
            on_release: root.dismiss()
        Button:
            text: 'Confirm'
            size_hint: btn_cancel.size_hint
            pos_hint: {'x': 0.7, 'y': 0.1}
            on_release: root.connect()
   
<Background@Widget>:
    canvas.before:
        Color:
            rgba: p.background
        Rectangle:
            pos: self.pos
            size: self.size
    
<TabbedPanelStrip>:
    canvas:
        Color:
            rgba: (0, 0, 0, 1) # black colour of the strip behind all 3 tab buttons
        Rectangle:
            size: self.size
            pos: self.pos

<StripLayout>: #a child of Gridlayout which is used by tabbedpanel, this disables padding
    padding: [0,0,0,0]
        





    
